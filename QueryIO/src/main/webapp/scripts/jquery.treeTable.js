(function(a){function g(a){for(var d=[];a=m(a);)d[d.length]=a[0];return d}function f(b){return a(b).siblings("tr."+c.childPrefix+b[0].id)}function n(a){a=parseInt(a[0].style.paddingLeft,10);return isNaN(a)?h:a}function k(b,d){var e=a(b.children("td")[c.treeColumn]);e[0].style.paddingLeft=n(e)+d+"px";f(b).each(function(){k(a(this),d)})}function l(b){if(!b.hasClass("initialized")){b.addClass("initialized");var d=f(b);!b.hasClass("parent")&&0<d.length&&b.addClass("parent");if(b.hasClass("parent")){var e=
a(b.children("td")[c.treeColumn]),g=n(e)+c.indent;d.each(function(){a(this).children("td")[c.treeColumn].style.paddingLeft=g+"px"});if(c.expandable){d='<a href="#" title="'+c.stringExpand+'" style="margin-left: -'+c.indent+"px; padding-left: "+c.indent+'px" class="expander"></a>';c.clickableNodeNames?e.wrapInner(d):e.html(d+e.html());a(e[0].firstChild).click(function(){b.toggleBranch();return!1}).mousedown(function(){return!1});a(e[0].firstChild).keydown(function(a){if(13==a.keyCode)return b.toggleBranch(),
!1});c.clickableNodeNames&&(e[0].style.cursor="pointer",a(e).click(function(a){"expander"!=a.target.className&&b.toggleBranch()}));if(e=c.persist)try{e="1"==j.get(b.attr("id"))}catch(h){e=!1}e&&b.addClass("expanded");!b.hasClass("expanded")&&!b.hasClass("collapsed")&&b.addClass(c.initialState);b.hasClass("expanded")&&b.expand()}}}}function p(b,d){b.insertAfter(d);f(b).reverse().each(function(){p(a(this),b[0])})}function m(b){for(var d=b[0].className.split(" "),e=0;e<d.length;e++)if(d[e].match(c.childPrefix))return a(b).siblings("#"+
d[e].substring(c.childPrefix.length));return null}function q(a){if(a.hasClass("expanded"))try{j.set(a.attr("id"),"1")}catch(d){}else try{j.remove(a.attr("id"))}catch(c){}}var c,h,j;a.fn.treeTable=function(b){c=a.extend({},a.fn.treeTable.defaults,b);c.persist&&(j=new Persist.Store(c.persistStoreName));return this.each(function(){a(this).addClass("treeTable").find("tbody tr").each(function(){if(!a(this).hasClass("initialized")){var b=-1==a(this)[0].className.search(c.childPrefix);b&&isNaN(h)&&(h=parseInt(a(a(this).children("td")[c.treeColumn]).css("padding-left"),
10));!b&&(c.expandable&&"collapsed"==c.initialState)&&a(this).addClass("ui-helper-hidden");(!c.expandable||b)&&l(a(this))}})})};a.fn.treeTable.defaults={childPrefix:"child-of-",clickableNodeNames:!1,expandable:!0,indent:19,initialState:"collapsed",onNodeShow:null,onNodeHide:null,treeColumn:0,persist:!1,persistStoreName:"treeTable",stringExpand:"Expand",stringCollapse:"Collapse"};a.fn.expandAll=function(){a(this).find("tr").each(function(){a(this).expand()})};a.fn.collapseAll=function(){a(this).find("tr").each(function(){a(this).collapse()})};
a.fn.collapse=function(){return this.each(function(){a(this).removeClass("expanded").addClass("collapsed");c.persist&&q(a(this));f(a(this)).each(function(){a(this).hasClass("collapsed")||a(this).collapse();a(this).addClass("ui-helper-hidden");a.isFunction(c.onNodeHide)&&c.onNodeHide.call(this)})})};a.fn.expand=function(){return this.each(function(){a(this).removeClass("collapsed").addClass("expanded");c.persist&&q(a(this));f(a(this)).each(function(){l(a(this));a(this).is(".expanded.parent")&&a(this).expand();
a(this).removeClass("ui-helper-hidden");a.isFunction(c.onNodeShow)&&c.onNodeShow.call(this)})})};a.fn.reveal=function(){a(g(a(this)).reverse()).each(function(){l(a(this));a(this).expand().show()});return this};a.fn.appendBranchTo=function(b){var d=a(this),e=m(d),f=a.map(g(a(b)),function(a){return a.id});if(-1==a.inArray(d[0].id,f)&&(!e||b.id!=e[0].id)&&b.id!=d[0].id)k(d,-1*g(d).length*c.indent),e&&d.removeClass(c.childPrefix+e[0].id),d.addClass(c.childPrefix+b.id),p(d,b),k(d,g(d).length*c.indent);
return this};a.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments)};a.fn.toggleBranch=function(){a(this).hasClass("collapsed")?a(this).expand():a(this).collapse();return this}})(jQuery);